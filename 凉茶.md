# 凉茶互动原型 / 游戏设计文档 (Draft v0.2)

## 目录
1. 项目概述与愿景
2. 设计目标与体验基调
3. 关键受众与用户画像
4. 核心玩法循环 (Core Loop)
5. MVP 范围定义
6. 功能列表 (分阶段)
7. 交互与信息架构概览
8. 系统与数据模型草案
9. 技术栈与工程规划
10. UI 布局草图说明
11. 动画 / 反馈与可感知性策略
12. 美术与资源规范（含你已有清单）
13. 音频 / 字体与氛围营造
14. 可访问性 / 多语言与本地化
15. 进度里程碑 (8h 原型 -> 4 周扩展示例)
16. 质量指标与度量
17. 风险与缓解策略
18. 未来扩展路线 (Roadmap)
19. 附录：原始分步骤清单与素材池

---

## 1. 项目概述与愿景
围绕“中式凉茶调配”文化主题，打造一个兼具教育、疗愈与轻策略决策的像素互动体验。通过拖拽药材、配伍、煎煮与反馈循环，让玩家在低压力语境中理解常见草本功效。

## 2. 设计目标与体验基调
情绪：宁静 / 木质 / 草本。 节奏：中低速，可暂停。 视觉：暖色复古像素 + 中式元素 UI 装饰。 交互语气：提示式、非打断。 学习方式：通过使用获得功效认知，而非考试。

## 3. 关键受众与用户画像
画像 A 放松型：碎片时间 5-15 分钟，追求舒缓。 画像 B 轻策略型：喜欢尝试组合优化评分。 画像 C 叙事型：关注角色与分支。 MVP 以 A 为核心，B 次要，C 为后期扩展。

## 4. 核心玩法循环 (Core Loop)
接收目标/自由探索 -> 选择药材 -> 拖入煲 -> 煎煮（动画）-> 反馈（评分/功效/图鉴解锁）-> 解锁/激励 -> 再次选择。 支撑循环：图鉴收藏、顾客经济（经营模式）、叙事推进（故事模式）。

## 5. MVP 范围定义
Must: 拖拽药材进锅 + 展示药材信息 + 基础煎煮动画 + 至少 6 种药材数据。 Should: 简单配伍评分 + 图鉴面板。 Could: 顾客症状提示 + 简易经济计数。 Won't (此阶段): 复杂天气、深度 buff/debuff、在线要素。

## 6. 功能列表 (分阶段)
模块 -> MVP / 扩展 1 / 扩展 2：
- 药材库：静态数组 -> 标签过滤 -> 稀有度与解锁逻辑。
- 拖拽：单件 -> 多选 / 轨迹特效 -> 拖拽排序回收。
- 煎煮：按钮触发烟雾 -> 进度条(香燃烧) -> 火候调节影响评分。
- 评分：线性求和 -> tag 组合加成 -> 隐藏秘方成就。
- 图鉴：列表 -> 搜索/筛选 -> 配伍关系图。
- 顾客：占位文本 -> 立绘 + 耐心条 -> 情绪动态与声誉系统。
- 经济：无 -> 铜钱 + 解锁 -> 动态需求 / 物价波动。
- 本地化：中文硬编码 -> i18n key -> 多语言包。
- 动画反馈：hover 缩放 -> 水墨粒子 -> 组合完成光环。

## 7. 交互与信息架构概览
主界面：左栏(药材) / 中央(锅+投放区) / 右侧(信息&反馈)。 顶部：店名、资源（铜钱、声望）。 底部：操作（煎煮 / 图鉴 / 帮助）。 信息优先级：实时配伍状态 > 药材细节 > 历史记录。

## 8. 系统与数据模型草案
interface Herb { id:string; name:string; tags:string[]; effects:EffectRef[]; description:string; discovered:boolean; icon:string; rarity?:number }
interface EffectRef { type:string; potency:number }
interface RecipeResult { herbIds:string[]; totals:Record<string,number>; score:number; secret?:boolean }
interface Customer { id:string; persona:string; needTags:string[]; patience:number; mood:'happy'|'neutral'|'sad' }
评分: Σ(需求标签 potency) - 0.5 * 非需求标签计数。

## 9. 技术栈与工程规划
Vite + React + TS。 动画：Framer Motion。 拖拽：@dnd-kit/core。 状态：React Context + reducer (后续可迁移 Zustand)。 测试：Vitest (后期)。 结构建议：src/components / hooks / data / state。 资产：public/icons, public/sprites。 未来 i18n: src/i18n/xx.json。

## 10. UI 布局草图说明
桌面：12 列；移动端：上下折叠（先锅后药材列表或反之 A/B）。 图标尺寸：16px 基础 / hover 1.15 缩放。 投放区：圆形热点 + 边缘高亮。 信息面板：最近投入顺序 + 累计功效水平条。

## 11. 动画 / 反馈与可感知性策略
层级：基础(hover/press) -> 操作(拖拽起始缩放+阴影) -> 结果(成功光晕/失败抖动) -> 全局(煎煮烟雾循环 opacity/keyframes)。 使用 transform/opacity 保性能。 失败与成功加入形状/图标避免仅凭颜色。

## 12. 美术与资源规范（整合）
像素基线：16x16；必要时 32x32 兼容放大。 调色板：≤32 主色 + 限制高光/阴影；主材色：木 (#8b5a2b)、纸 (#f3e2c7)、草本绿 (#5c7f4b)、点缀朱红 (#c44832)。 命名：herb_[pinyin].png, ui_btn_[action]_[state].png。 目录：/art/WIP /art/export/icons /art/export/ui。

## 13. 音频 / 字体与氛围
字体：开源楷体候选（LXGW WenKai / Smiley Sans 需评估可读性）。 环境：微风+木结构吱声淡混响。 交互：投放“木陶”轻击、煮沸柔和水泡。 完成：淡和弦。 提供静音与音量滑块（后期）。

## 14. 可访问性 / 本地化
对比度>=4.5:1。 键盘计划：Tab 聚焦药材 -> Enter 投放 -> Space 煎煮。 屏幕阅读预留 aria-label (herb name + primary effect)。 文案抽取 keys：herb.gouqi.name 等。

## 15. 进度里程碑 (示例)
8h 原型：Must 全部完成。 Week1：评分+图鉴+10 药材。 Week2：顾客 v1 + 经济计数。 Week3：动画层级 + 本地化架构。 Week4：平衡 / QA / 体验打磨。

## 16. 质量指标与度量
性能：初次交互延迟 <1s；50 次拖放无卡顿。 稳定：核心交互错误率 <1%。 参与：平均使用药材种类 >=5/局。 学习：玩家 3 局后能回忆 ≥3 功效。 可维护：关键模块 <200 行/文件。

## 17. 风险与缓解
美术产能不足 -> 占位符 + 批量调色模板。 范围膨胀 -> 严格按 Must/Should/Could gate。 数值复杂 -> Start 简单线性 + Tag 加成。 文化准确性 -> 明确“游戏化简化”免责声明。 动画性能 -> 避免 box-shadow 动画/布局抖动。

## 18. 未来扩展路线
节气活动 / 社交配方分享图 / 顾客队列策略 / 秘方发现日志 / 成就称号 / 成分冲突 debuff / 移动端适配 / 云存档。

## 19. 附录：原始分步骤清单与素材池

---

## **第一步：制作美术资源**

*   **目标：** 画出以下**2样东西**：
    1.  **一个像素风的小碗。**
    2.  **一味中药材的像素图标**（比如枸杞、菊花、甘草）。尺寸：16x16 或 32x32像素。

## **第二步：构建网页交互原型（今天的目标）**
*   **任务：** 用Vite + React + TypeScript + Framer Motion + @dnd-kit/core，做一个**非游戏的交互页面**。
*   **时间：** 4小时内完成。
*   **分解步骤：**
    1. 前1小时：搭建静态页面布局（左边药材栏，中间煲，右边信息区）。
    2. 第2小时：实现拖拽功能，把药材拖到煲里。
    3. 第3小时：添加点击显示药材信息功能。
    4. 第4小时：实现“煎煮”动画。
*   **功能：**
    1.  页面左边是你画好的几种药材图标。
    2.  页面中间是一个煲。
    3.  玩家可以**拖拽**药材到煲里。
    4.  每拖入一种药材，煲旁边就显示这种药材的名称和简介（例如：“甘草：性平，味甘，用于调和诸药”）。
    5.  （进阶）点击“煎煮”按钮，显示一个简单的“煎煮”动画（比如煲里冒烟）。

## **第三步：基于原型，定义“游戏类型”**

*   **选项A：【模拟经营类】**
    *   **玩法：** 顾客来到你的凉茶铺，描述他们的症状（“我上火/湿气重/睡不好”）。你需要从你的药材库中，拖拽正确的药材进行配伍，满足顾客需求。
    *   **为什么匹配？** 原型直接就是核心玩法。你需要扩展的只是顾客系统、评分系统和经济系统。

*   **选项B：【叙事解谜类】（更独特！）**
    *   **玩法：** 作为一个小学徒，你通过为不同角色配置特定的凉茶，来推动剧情发展。给错茶会导致分支剧情。
    *   **为什么匹配？** 核心不变，但赋予了它叙事和选择的重量。

*   **选项C：【放松/冥想类】**
    *   **玩法：** 没有目标，只有一个虚拟的凉茶工作台，玩家可以自由地探索和组合药材，了解其属性，并“煎煮”出一杯属于自己的、像素风的凉茶，伴随着舒缓的音乐。

## **第四步：扩展游戏内容**

以下是一些常见的中药材和凉茶相关器具：

枸杞、菊花、人参、桂圆、金银花、生姜、葫芦、甘草片、薄荷、香囊、
蒲葵扇、山楂、陶罐、艾叶、茯苓（碗）、陶碗、芍药、油纸伞、石磨、紫砂碗、
竹篓、帷帽（斗笠）、当归片（碗）、石臼、药罐、竹蒸笼、铜壶、陶瓷碗、竹凳、铜药碾、
黄连、决明子、鸡公碗（空）、竹编筲箕、酒旗、长条凳、远志、紫苏、粗陶坛、线装书、
陈皮

## **第五步：补充美术资源（后续目标）**

### 一、 UI界面核心资源（急需）

这些是构成游戏界面框架所必需的视觉元素：

1.  **背景与底板：**
    *   **UI底板/面板：** 各种形状和大小的木质卷轴、丝绸卷轴、木牌、石碑，用于承载文字和按钮。

2.  **按钮：**
    *   **通用按钮：** 设计成“葫芦”、“印章”、“铜钱”、“荷叶”等形状的按钮。
    *   **状态按钮：** 每个按钮需要有**正常、悬停、按下、禁用** 三种状态。

3.  **图标：**
    *   **功能图标：** “开始游戏”、“设置”、“退出”、“返回”、“帮助”、“商店”、“仓库”。
    *   **属性图标：** 代表凉茶的“功效”，例如：
        *   **清热解毒：** 火焰被水浇灭的图标。
        *   **生津止渴：** 一滴水或一片薄荷叶。
        *   **健脾开胃：** 一个小碗和筷子。
        *   **安神补脑：**  ZZz睡眠符号或一颗发光的大脑。
        *   **顾客满意度：** 笑脸/普通脸/哭脸。
        *   **金钱：** 铜钱或元宝图标。
        *   **声望/经验：** 一颗星星或一个上升的箭头。

4.  **进度条与状态条：**
    *   **熬制进度条：** 设计成一根正在燃烧的香。
    *   **顾客耐心条：** 一个简单的横条，可以用暖色（绿色/黄色）到冷色（红色）的渐变来表示。
    *   **体力/精力条：** 你的角色每天可进行的操作次数。

5.  **字体：**
    *   找一款免费的**书法字体**或**楷体**，用于游戏内的所有文字，能极大地提升整体氛围。

### 二、 游戏功能与氛围补充资源

1.  **顾客相关：**
    *   **顾客造型：** 设计几种不同风格的古风顾客，例如：书生、小姐、农夫、商人、孩童。他们可以有不同的状态（如“上火”、“疲惫”、“腹胀”）。
    *   **对话框：** 云朵形或卷轴形的对话框。

2.  **店铺装饰与扩展：**
    *   **店铺招牌：** 您有“酒旗”，可以再做一个固定的匾额，写上您的店名。
    *   **柜台：** 顾客和玩家交互的核心区域。
    *   **灶台/工作台：** 熬制凉茶的地方，上面可以放置您的**铜壶、药罐**等。
    *   **储物架/药柜：** 上面可以摆放您的**陶罐、粗陶坛、竹篓**，用于显示库存。
    *   **装饰物：** 悬挂的**香囊**、盆栽（如**芍药、菊花**）、灯笼、字画、算盘。

3.  **反馈与特效：**
    *   **点击特效：** 点击药材或按钮时，出现水墨涟漪、星光或叶子飘落的效果。
    *   **合成/熬制成功特效：** 一道柔和的光晕或几片花瓣升起。
    *   **金币获得特效：** 铜钱蹦出的动画。
    *   **负面状态特效：** 顾客头上出现小火苗（表示上火）、漩涡（表示头晕）等简单动画。

### 三、 对现有资源的再利用建议

*   **鸡公碗（空）：** 完美地用作顾客喝凉茶的碗。
*   **陶罐/粗陶坛：** 在UI中可以作为“库存”或“仓库”的图标。
*   **铜钱/元宝：** 直接作为游戏内货币图标。
*   **线装书：** 可以作为“配方图鉴”或“帮助菜单”的界面背景。

---

## 追加：数据示例 (实现参考)
建议新增 `src/data/herbs.ts`：
```ts
export interface Herb { id:string; name:string; tags:string[]; effects:{type:string; potency:number}[]; description:string; discovered:boolean; icon:string }
export const herbs: Herb[] = [
    { id: 'gouqi', name: '枸杞', tags: ['滋补','明目'], effects: [{type:'滋补', potency:2}], description:'性平，味甘，养肝明目。', discovered: true, icon: 'herb_gouqi.png' },
    { id: 'juhua', name: '菊花', tags: ['清热','明目'], effects: [{type:'清热', potency:2}], description:'疏风清热，平肝明目。', discovered: true, icon: 'herb_juhua.png' },
    { id: 'gancao', name: '甘草', tags: ['调和'], effects: [{type:'调和', potency:3}], description:'性平，味甘，用于调和诸药。', discovered: true, icon: 'herb_gancao.png' }
];

export function scoreRecipe(needTags: string[], recipe: Herb[]): number {
    const totals: Record<string, number> = {};
    recipe.forEach(h => h.effects.forEach(e => { totals[e.type] = (totals[e.type]||0) + e.potency; }));
    const base = needTags.reduce((s, tag) => s + (totals[tag]||0), 0);
    const penalty = Object.keys(totals).filter(t => !needTags.includes(t)).length * 0.5;
    return Math.max(0, base - penalty);
}
```

> 注：示例算法为临时线性模型，后期可引入加成 / 阈值 / 冲突表。
